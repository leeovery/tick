AGENT: duplication
FINDINGS:
- FINDING: Ready query SQL conditions duplicated between list.go and stats.go
  SEVERITY: medium
  FILES: /Users/leeovery/Code/tick/internal/cli/list.go:211-224, /Users/leeovery/Code/tick/internal/cli/stats.go:86-99
  DESCRIPTION: The ready-task SQL logic (status='open' AND NOT EXISTS unclosed blockers AND NOT EXISTS open children) is written independently in two places. In list.go (buildListQuery), it appears as three separate condition strings totaling ~12 lines of SQL. In stats.go (RunStats), it appears as a standalone COUNT(*) query with the same ~12 lines of SQL subqueries. The two NOT EXISTS subqueries are semantically identical but were authored separately. If the definition of "ready" changes (e.g., adding a new condition), both must be updated in sync -- exactly the drift risk code-quality.md warns about under "Compose, Don't Duplicate."
  RECOMMENDATION: Extract the two NOT EXISTS subquery clauses as named SQL constants (e.g., readyBlockerCondition and readyChildCondition) in a shared location such as list.go or a new query_helpers.go. Both buildListQuery and RunStats compose their queries from these constants. The stats blocked count already correctly derives from open - ready, so only the ready SQL needs consolidation.

- FINDING: Store boilerplate (DiscoverTickDir + NewStore + defer Close) repeated across 9 command handlers
  SEVERITY: medium
  FILES: /Users/leeovery/Code/tick/internal/cli/create.go:104-113, /Users/leeovery/Code/tick/internal/cli/dep.go:66-75, /Users/leeovery/Code/tick/internal/cli/dep.go:139-148, /Users/leeovery/Code/tick/internal/cli/list.go:90-99, /Users/leeovery/Code/tick/internal/cli/rebuild.go:14-23, /Users/leeovery/Code/tick/internal/cli/show.go:45-54, /Users/leeovery/Code/tick/internal/cli/stats.go:19-28, /Users/leeovery/Code/tick/internal/cli/transition.go:21-30, /Users/leeovery/Code/tick/internal/cli/update.go:123-132
  DESCRIPTION: Every Run* function that accesses the store repeats the same 8-line sequence: DiscoverTickDir(dir), storage.NewStore(tickDir, storeOpts(fc)...), defer store.Close(). This identical block appears 9 times across 8 files (dep.go has it twice for RunDepAdd and RunDepRm). Each instance uses the same arguments (dir, fc) and produces the same local variables (tickDir, store, err). The pattern is mechanical boilerplate with no variation.
  RECOMMENDATION: Extract an openStore(dir string, fc FormatConfig) (*storage.Store, error) helper that encapsulates DiscoverTickDir + NewStore. Callers reduce to store, err := openStore(dir, fc) + defer store.Close(). This eliminates ~5 lines of duplication per call site (~45 lines total). The defer store.Close() must remain at each call site since Go defers are scope-bound.

- FINDING: Getwd + error wrapping repeated 11 times in app.go handler methods
  SEVERITY: low
  FILES: /Users/leeovery/Code/tick/internal/cli/app.go:94-97, /Users/leeovery/Code/tick/internal/cli/app.go:103-106, /Users/leeovery/Code/tick/internal/cli/app.go:111-114, /Users/leeovery/Code/tick/internal/cli/app.go:125-128, /Users/leeovery/Code/tick/internal/cli/app.go:134-137, /Users/leeovery/Code/tick/internal/cli/app.go:143-146, /Users/leeovery/Code/tick/internal/cli/app.go:156-159, /Users/leeovery/Code/tick/internal/cli/app.go:169-172, /Users/leeovery/Code/tick/internal/cli/app.go:178-181, /Users/leeovery/Code/tick/internal/cli/app.go:187-190, /Users/leeovery/Code/tick/internal/cli/dep.go:15-18
  DESCRIPTION: Every handler method calls a.Getwd() with the same 4-line error-check-and-wrap block. All 11 occurrences are in a single file (app.go, plus dep.go handleDep) making this low-impact for cross-file concerns, but it is substantial within the file. Each uses the identical error message "could not determine working directory".
  RECOMMENDATION: Extract a getWorkDir(a *App) (string, error) method or call Getwd once in the dispatcher (Run) and pass dir to all handler methods. The latter is cleaner since dir never varies per invocation. Low priority since all instances are in one file and each is only 4 lines.

- FINDING: Duplicate relatedTask struct (unexported) shadows exported RelatedTask
  SEVERITY: low
  FILES: /Users/leeovery/Code/tick/internal/cli/show.go:30-34, /Users/leeovery/Code/tick/internal/cli/format.go:88-92
  DESCRIPTION: show.go defines an unexported relatedTask{id, title, status string} struct used only in queryShowData, while format.go defines the exported RelatedTask{ID, Title, Status string} with identical fields. The showDataToTaskDetail function (show.go:176-191) then loops through each relatedTask and converts it to a RelatedTask by copying field by field. The two structs are structurally identical -- the only difference is export visibility and field naming conventions (lowercase vs uppercase).
  RECOMMENDATION: Use RelatedTask directly in queryShowData instead of the unexported relatedTask. The SQL Scan calls can target RelatedTask fields directly (&r.ID, &r.Title, &r.Status). This eliminates the relatedTask struct, the two conversion loops in showDataToTaskDetail, and ~15 lines of mapping code.

SUMMARY: Two medium-severity findings remain: the ready-query SQL conditions are independently duplicated between list.go and stats.go (~12 lines of identical SQL logic at risk of drift), and the store-opening boilerplate (DiscoverTickDir + NewStore + Close) is repeated 9 times across 8 files. Two low-severity findings cover the Getwd pattern in app.go and a duplicate relatedTask struct in show.go. All high/medium findings from cycle 1 (cache freshness, baseFormatter, applyBlocks, parseCommaSeparatedIDs) were successfully consolidated.
